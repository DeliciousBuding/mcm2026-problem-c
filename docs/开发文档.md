# 开发文档（中文）

## 1. 项目结构
- `src/pipeline.py`：主数据建模与可视化流水线（含必要注释）。
- `paper/main.tex`：论文主文件（含指标与图表嵌入）。
- `paper/figures/`：自动生成图表输出目录。
- `outputs/`：中间结果与汇总指标（JSON/CSV/LaTeX 宏）。
- `docs/`：开发文档与功能说明。

## 2. 环境与依赖
- 运行环境：Miniforge + `mcm2026`。
- 主要依赖：`numpy pandas matplotlib seaborn scipy statsmodels scikit-learn pulp`。
- 说明：Pulp 仅保留接口，实际 LP 求解已在极速版中跳过以提高速度。

## 3. 数据输入
- 文件：`2026_MCM_Problem_C_Data.csv`。
- 格式：宽表，包含 `weekX_judgeY_score` 与选手元数据。

## 4. 运行流程
在项目根目录执行：
```bat
conda activate mcm2026
python -u src\pipeline.py
```

## 5. 输出产物
- 图表：`paper/figures/*.pdf`
- 汇总指标：`outputs/summary_metrics.json`、`outputs/summary_metrics.csv`
- LaTeX 宏：`paper/summary_metrics.tex`

## 6. 速度优化说明
- `sample_week_percent` 与 `lp_bounds_and_slack` 已替换为极速版本。
- 采样与约束检查向量化，LP 求解跳过。
- 机制评估已全向量化，移除逐样本 Python 循环。
- 参考运行耗时：N_PROPOSALS=250 时约 16–20 秒（单核，依机器而定）。
- 如需提升精度（N_PROPOSALS 上调），耗时近似线性增加，可再考虑多进程分季并行。

## 7. 论文编译
在 `paper` 目录执行：
```bat
pdflatex -interaction=nonstopmode -halt-on-error main.tex
xelatex -interaction=nonstopmode -halt-on-error main_zh.tex
```

## 8. 版本管理约定
- 每次关键迭代完成后执行 `git add` + `git commit`。
- 提交信息使用中文。

## 9. 当前进度（2026-01-31）
- 数据管道完成：完成从原始 CSV 到后验估计、指标计算与图表输出的全流程。
- 极速采样启用：`sample_week_percent` 和 `lp_bounds_and_slack` 使用极速版本，单核运行时间约 20 秒级（N_PROPOSALS=250）。
- 机制评估优化：淘汰与指标计算向量化，减少 Python 循环与中间存储。
- 图表齐全：已生成不确定性热图、错误淘汰热图、冲突散点、规则切换、DAWS 权衡、争议案例密度、决赛流向、预测 AUC 等图表。
- 论文集成完成：图表与指标已嵌入 `paper/main.tex`，ControlNumber 已更新为 2617892；中文报告 `paper/main_zh.tex` 可编译生成。
- 文档整理完成：根目录题目/规范/框架/题目详情文件已移动到 `docs/` 并做简要合并说明。
